<!DOCTYPE html>
<html>
<head>
  <!-- This code belongs to public domain (2023) -->
<title>Additive synthesizer</title>
<style>

#docfooter {
  /*background-color: red;*/
}


#table1 {
}

#tableDiv {
  max-width: fit-content;
  margin-left: auto;
  margin-right: auto;
}

#HarmonicsSwitchDiv {
  max-width: fit-content;
  margin-left: auto;
  margin-right: auto;
}

#controlsDiv {
  max-width: fit-content;
  margin: auto;
  /*text-align: left;*/
  display: flex; 
  flex-direction: row;
  justify-content: center;
  align-items: center;
}

.ADSRClass {
  padding: 10px;
}
.LowerMenuButtons {
  padding: 10px;
}

</style>

  <script src="wavefile.js"></script>
	<script src="adder.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/cdn/themes/light.css" />
  <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.0/cdn/shoelace-autoloader.js"></script>

</head>

<body onload="initializeUI()">

  <h1 style="text-align: center;">Additive Synthesis Sound Generator</h1>


  <div id="tableDiv" >
    <table style="display:initial;" id="table1">
      <tr>
        <td><sl-range id="W1FRange" min="0" max="5000" step="1" help-text="Wave 1 Frequency" tooltip="bottom" style="width:800px;" oninput="W1FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W1FInput" help-text="W1 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W1Weight" min="0" max="1" step="0.01" help-text="Wave 1 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W2FRange" min="0" max="5000" step="1" help-text="Wave 2 Frequency" tooltip="bottom" style="width:800px;" oninput="W2FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W2FInput" help-text="W2 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W2Weight" min="0" max="1" step="0.01" help-text="Wave 2 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W3FRange" min="0" max="5000" step="1" help-text="Wave 3 Frequency" tooltip="bottom" style="width:800px;" oninput="W3FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W3FInput" help-text="W3 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W3Weight" min="0" max="1" step="0.01" help-text="Wave 3 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W4FRange" min="0" max="5000" step="1" help-text="Wave 4 Frequency" tooltip="bottom" style="width:800px;" oninput="W4FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W4FInput" help-text="W4 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W4Weight" min="0" max="1" step="0.01" help-text="Wave 4 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W5FRange" min="0" max="5000" step="1" help-text="Wave 5 Frequency" tooltip="bottom" style="width:800px;" oninput="W5FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W5FInput" help-text="W5 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W5Weight" min="0" max="1" step="0.01" help-text="Wave 5 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W6FRange" min="0" max="5000" step="1" help-text="Wave 6 Frequency" tooltip="bottom" style="width:800px;" oninput="W6FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W6FInput" help-text="W6 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W6Weight" min="0" max="1" step="0.01" help-text="Wave 6 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W7FRange" min="0" max="5000" step="1" help-text="Wave 7 Frequency" tooltip="bottom" style="width:800px;" oninput="W7FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W7FInput" help-text="W7 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W7Weight" min="0" max="1" step="0.01" help-text="Wave 7 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W8FRange" min="0" max="5000" step="1" help-text="Wave 8 Frequency" tooltip="bottom" style="width:800px;" oninput="W8FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W8FInput" help-text="W8 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W8Weight" min="0" max="1" step="0.01" help-text="Wave 8 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W9FRange" min="0" max="5000" step="1" help-text="Wave 9 Frequency" tooltip="bottom" style="width:800px;" oninput="W9FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W9FInput" help-text="W9 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W9Weight" min="0" max="1" step="0.01" help-text="Wave 9 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W10FRange" min="0" max="5000" step="1" help-text="Wave 10 Frequency" tooltip="bottom" style="width:800px;" oninput="W10FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W10FInput" help-text="W10 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W10Weight" min="0" max="1" step="0.01" help-text="Wave 10 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
      <tr>
        <td><sl-range id="W11FRange" min="0" max="5000" step="1" help-text="Wave 11 Frequency" tooltip="bottom" style="width:800px;" oninput="W11FrequencySliderOnInput()" value="440"></sl-range></td>
        <td><sl-input id="W11FInput" help-text="W11 Frequency" style="width:100px;" value="440"> </sl-input></td>
        <td><sl-range id="W11Weight" min="0" max="1" step="0.01" help-text="Wave 11 Weight" tooltip="bottom" value="1" oninput="WeightSliderOnInput()"></sl-range></td></td>
      </tr>
    </table> 
  </div>

  <div id="HarmonicsSwitchDiv">
    <sl-radio-group id="SelectHarmonicsOptionRG" value="1" onclick="SelectHarmonicsOptionRGOnChange()">
      <sl-radio-button value="1">Free</sl-radio-button>
      <sl-radio-button value="2">Harmonics</sl-radio-button>
    </sl-radio-group>
  </div>

  <sl-divider></sl-divider>

  <!-- Shoelace Dialog-->
  <sl-dialog label="WebMIDI" class="dialog-overview" id="MIDIDialog">
    Now you can use your MIDI device and computer keyboard.
    <!-- <sl-button slot="footer" variant="primary" onclick="MIDIDialogCloseButtonClick()" id="MIDIDialogCloseButton">Close</sl-button> -->
  </sl-dialog>
  <!-- Shoelace Dialog-->

  <div id=controlsDiv>
    <sl-button onclick="PlayButtonClick()" class="LowerMenuButtons">Play</sl-button>
    <sl-button onclick="DownloadWAVClick()" class="LowerMenuButtons">Download WAV</sl-button>
    <sl-button onclick="TestSoundClick()" class="LowerMenuButtons">Test Sound</sl-button>
    <sl-button onclick="StopTestClick()" class="LowerMenuButtons">Stop Test</sl-button>
    <sl-button onclick="CheckWebMidiClick()" class="LowerMenuButtons">WebMIDI</sl-button>
    <sl-range id="AttackRange" min="0" max="1" step="0.01" value="0.1" help-text="Attack duration (s)" tooltip="bottom" class="ADSRClass"></sl-range>    
    <sl-range id="DecayRange" min="0" max="1" step="0.01" value="0.1" help-text="Decay duration (s)" tooltip="bottom" class="ADSRClass"></sl-range>    
    <sl-range id="SustainDurationRange" min="0" max="3" step="0.01" value="1" help-text="Sustain duration (s)" tooltip="bottom" class="ADSRClass"></sl-range>    
    <sl-range id="SustainVolumeRange" min="0" max="1" step="0.01" value="0.7" help-text="Sustain Volume (%)" tooltip="bottom" class="ADSRClass"></sl-range>    
    <sl-range id="ReleaseRange" min="0" max="1" step="0.01" value="0.1" help-text="Release duration (s)" tooltip="bottom" class="ADSRClass"></sl-range>    
    <sl-button onclick="SaveButtonClick()" class="LowerMenuButtons">Save</sl-button>
    <sl-button onclick="LoadButtonClick()" class="LowerMenuButtons">Load</sl-button>
  </div>

  <input type="file" id="my_file" style="display: none;"> <!-- hidden because we will trigger it from the Load Button -->

<!-- Here it goes the description and information-->

<h2>Information</h2>
<p>
  This is an additive synthesizer made in HTML and Javascript I made as a hobbie. It's meant to be used as a toy to create new sounds used later in a sampler or similar device.
  The source code belongs to public domain. It's intended to be as small and simple as possible so that someone with little programming knowledge can understant and modify it.
  <a href="./"> Download all the files </a>.
</p>
<h2>How do I use this thing</h2>
  <h3>Buttons</h3>
    <p><b>Test Sound:</b> This button is used to play the current sound in a loop. You can then use the sliders and text boxes to adjust the parameters at your will.</p>
    <p><b>Stop Test:</b> Stops the sound test.</p>
    <p><b>Play Sound:</b> This button is used to play the current sound once, with the wave shape (ADSR) applied. </p>
    <p><b>Download WAV:</b> Downloads a WAV file with the sound. Wave shape (ADSR) is applied.</p>
    <p><b>Check Web MIDI:</b> Loads the MIDI sound processor and starts the MIDI devices. Clicking here should allow you to use your MIDI keyboard. It also allows you to play via computer keyboard.</p>
    <p><b>Save:</b> Saves the current instrument being configured to a json file.</p>
    <p><b>Load:</b> Loads an instrument from a json file.</p>

    <p>Usually you would play with Test Sound and the sliders, fine tune it with the values of frequencies in the text boxes. Play the sound with the computer or midi keyboard, and download it.</p>
  <h3>Wave Shape</h3>
    <img src="ws.png" alt="wave shape visualization"> 
    <p><b>Attack:</b> Duration of transition from volume 0 to volume 1.</p>
    <p><b>Decay:</b> Duration of transition from volume 1 to Sustain Volume.</p>
    <p><b>Sustain:</b> Duration of volume set to Sustain Volume</p>
    <p><b>Sustain Volume:</b> Value from 0 (min) to 1 (max). It's the volume ratio sustained during all the Sustain period.</p>
    <p><b>Release:</b> Duration of transition from Sustain Volume to 0.</p>

<h2>Known Bugs</h2>
  <h3>Cracks in sounds when playing midi keyboard in Chrome</h3>
  <p>
    Due to the way audio samples are mixed, that is, simply adding them arithmetically, when two or more midi keys are pressed in Chrome a cracking sound might appear. 
    You can alternatively use Firefox. This issue is fixed in Firefox.
  </p>
  
  

<footer id="docfooter">

</footer>

</body>
</html>
